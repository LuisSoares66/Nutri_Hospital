{% extends "base.html" %}

{% block content %}
<div class="container">

  <h1>Hospitais</h1>

  <!-- A√á√ïES DO TOPO (APARECE UMA VEZ) -->
  <div class="actions" style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:20px;">

    <a class="btn primary" href="{{ url_for('main.novo_hospital') }}">
      + Novo Hospital
    </a>

    <a class="btn secondary" href="{{ url_for('main.relatorios_geral') }}">
      üìä Relat√≥rios (Geral)
    </a>

    <a class="btn secondary" href="{{ url_for('main.hospital_info', hospital_id=h.id) }}">
      INFO
    </a>


    {% if session.get("is_admin") %}
      <a class="btn secondary" href="{{ url_for('main.admin_panel') }}">üîí Admin</a>
      <a class="btn danger" href="{{ url_for('auth.admin_logout') }}">Sair Admin</a>
    {% else %}
      <a class="btn secondary" href="{{ url_for('auth.admin_login') }}">üîë Login Admin</a>
    {% endif %}

  </div>

  <!-- LISTA -->
  {% if hospitais %}
    <table class="table">
      <thead>
        <tr>
          <th style="width:80px;">ID</th>
          <th>Nome do Hospital</th>
          <th style="width:520px;">A√ß√µes</th>
        </tr>
      </thead>

      <tbody>
        {% for h in hospitais %}
        <tr>
          <td>{{ h.id }}</td>
          <td>{{ h.nome_hospital }}</td>

          <td style="display:flex; gap:10px; flex-wrap:wrap; align-items:flex-start;">

            <!-- CONTATOS -->
            <div style="display:flex; flex-direction:column; gap:6px;">
              <a class="btn secondary" href="{{ url_for('main.hospital_info', hospital_id=h.id) }}">INFO</a>
              <a class="btn secondary" href="{{ url_for('main.contatos', hospital_id=h.id) }}">CONTATOS</a>
              <a class="btn secondary" href="{{ url_for('main.editar_contatos', hospital_id=h.id) }}">‚úèÔ∏è EDITAR</a>
            </div>

            <!-- DADOS -->
            <div style="display:flex; flex-direction:column; gap:6px;">
              <a class="btn secondary" href="{{ url_for('main.dados_hospital', hospital_id=h.id) }}">DADOS</a>
              <a class="btn secondary" href="{{ url_for('main.editar_dados_hospital', hospital_id=h.id) }}">‚úèÔ∏è EDITAR</a>
            </div>

            <!-- PRODUTOS -->
            <div style="display:flex; flex-direction:column; gap:6px;">
              <a class="btn secondary" href="{{ url_for('main.produtos_hospital', hospital_id=h.id) }}">PRODUTOS</a>
              <a class="btn secondary" href="{{ url_for('main.editar_produtos_hospital', hospital_id=h.id) }}">‚úèÔ∏è EDITAR</a>
            </div>

            <!-- RELAT√ìRIOS -->
            <div style="display:flex; flex-direction:column; gap:6px;">
              <a class="btn secondary" href="{{ url_for('main.relatorios', hospital_id=h.id) }}">RELAT√ìRIOS</a>
            </div>

            <!-- APAGAR (S√ì ADMIN) -->
            {% if session.get("is_admin") %}
              <div style="display:flex; flex-direction:column; gap:6px;">
                <form method="POST"
                      action="{{ url_for('main.excluir_hospital', hospital_id=h.id) }}"
                      onsubmit="return confirm('Apagar APENAS este hospital e todos os dados relacionados?');"
                      style="display:inline;">
                  <button class="btn danger" type="submit">üóë APAGAR</button>
                </form>
              </div>
            {% endif %}

          </td>

        </tr>
        {% endfor %}
      </tbody>
    </table>

  {% else %}
    <p>Nenhum hospital cadastrado.</p>
  {% endif %}

</div>
{% endblock %}
