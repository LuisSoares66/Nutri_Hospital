{% extends "base.html" %}

{% block content %}
<div class="container">

  <h1>Hospitais</h1>

  <!-- AÃ‡Ã•ES DO TOPO (NÃƒO USA 'h') -->
  <div class="actions" style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:20px;">

    <a class="btn primary" href="{{ url_for('main.novo_hospital') }}">
      + Novo Hospital
    </a>

    <a class="btn secondary" href="{{ url_for('main.relatorios_geral') }}">
      ðŸ“Š RelatÃ³rios (Geral)
    </a>

    {% if session.get("is_admin") %}
      <a class="btn secondary" href="{{ url_for('main.admin_panel') }}">ðŸ”’ Admin</a>
      <a class="btn danger" href="{{ url_for('auth.admin_logout') }}">Sair Admin</a>
    {% else %}
      <a class="btn secondary" href="{{ url_for('auth.admin_login') }}">ðŸ”‘ Login Admin</a>
    {% endif %}

  </div>

  <!-- LISTA -->
  {% if hospitais %}
    <table class="table">
      <thead>
        <tr>
          <th style="width:80px;">ID</th>
          <th>Nome do Hospital</th>
          <th style="width:620px;">AÃ§Ãµes</th>
        </tr>
      </thead>

      <tbody>
        {% for h in hospitais %}
        <tr>
          <td>{{ h.id }}</td>
          <td>{{ h.nome_hospital }}</td>

          <td style="display:flex; gap:6px; flex-wrap:wrap; align-items:center;">

            <!-- INFO (AGORA DENTRO DO LOOP) -->
            <a class="btn secondary" href="{{ url_for('main.hospital_info', hospital_id=h.id) }}">
              INFO
            </a>

            <a class="btn secondary" href="{{ url_for('main.contatos', hospital_id=h.id) }}">
              CONTATOS
            </a>

            <a class="btn secondary" href="{{ url_for('main.dados_hospital', hospital_id=h.id) }}">
              DADOS
            </a>

            <a class="btn secondary" href="{{ url_for('main.produtos_hospital', hospital_id=h.id) }}">
              PRODUTOS
            </a>

            <a class="btn secondary" href="{{ url_for('main.relatorios', hospital_id=h.id) }}">
              RELATÃ“RIOS
            </a>

            <!-- APAGAR (SÃ“ ADMIN) -->
            {% if session.get("is_admin") %}
              <form method="POST"
                    action="{{ url_for('main.excluir_hospital', hospital_id=h.id) }}"
                    onsubmit="return confirm('Apagar APENAS este hospital e todos os dados relacionados?');"
                    style="display:inline;">
                <button class="btn danger" type="submit">
                  ðŸ—‘ APAGAR
                </button>
              </form>
            {% endif %}

          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

  {% else %}
    <p>Nenhum hospital cadastrado.</p>
  {% endif %}

</div>
{% endblock %}
