{% extends "base.html" %}

{% block content %}
<div class="container">

  <h1>Produtos – {{ hospital.nome_hospital }}</h1>

  <div class="actions" style="display:flex; gap:10px; flex-wrap:wrap; margin:16px 0;">
    <a class="btn secondary" href="{{ url_for('main.hospitais') }}">⬅ Voltar</a>
  </div>

  <hr>

  <!-- FORMULÁRIO: ADICIONAR PRODUTO -->
  <h2>Adicionar produto ao hospital</h2>

  {% if not catalogo or catalogo|length == 0 %}
    <p><b>Atenção:</b> não encontrei <code>data/produtos.xlsx</code> (ou está vazio). Envie o arquivo para a pasta <code>data</code> e tente novamente.</p>
  {% endif %}

  <form method="POST" style="margin: 16px 0;">
    <div style="display:grid; gap:10px; max-width: 680px;">

      <label><b>Produto (lista com rolagem)</b></label>

      <!-- Caixa rolável -->
      <select name="produto" size="12" required style="width:100%; padding:10px;">
        {% for item in catalogo %}
          <option value="{{ item.produto }}">{{ item.marca }} — {{ item.produto }}</option>
        {% endfor %}
      </select>

      <label><b>Marca (planilha)</b></label>
      <select name="marca_planilha" required style="width:100%; padding:10px;">
        <option value="PRODIET">PRODIET</option>
        <option value="NESTLÉ">NESTLÉ</option>
        <option value="DANONE">DANONE</option>
        <option value="FRESENIUS">FRESENIUS</option>
      </select>

      <label><b>Quantidade</b></label>
      <input type="number" name="quantidade" min="0" value="0" required>

      <button class="btn primary" type="submit">+ Adicionar</button>
    </div>
  </form>

  <hr>

  <!-- LISTA DE PRODUTOS CADASTRADOS -->
  <h2>Produtos cadastrados para este hospital</h2>

  {% if produtos|length == 0 %}
    <p>Nenhum produto cadastrado.</p>
  {% else %}
    <table class="table">
      <thead>
        <tr>
          <th>Marca</th>
          <th>Produto</th>
          <th>Quantidade</th>
        </tr>
      </thead>
      <tbody>
        {% for p in produtos %}
        <tr>
          <td>{{ p.marca_planilha or "" }}</td>
          <td>{{ p.produto }}</td>
          <td>{{ p.quantidade }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

</div>
{% endblock %}
